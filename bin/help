#!/bin/bash

# Import color
source $AV_CONFIG_DIR/default_imports

avCheckHelpFlags "$1" "builtin" "What you see here" "\n \
This runs all the commands with a -h.  Also sets \n \
the AV_SINGLE_LINE_HELP variable which should make\n \
each command produce a single line of help.  We section\n \
by the folders under .av/bin/.\n \
\n"

$AV_CONFIG_DIR/welcome

# Import system path
avRestoreSystemPath

#### Put system commands here

# Plugins / global commands
export AV_SINGLE_LINE_HELP=true  
echo
av_path="$AV_INSTALLED_BIN"
plugin_config=$AV_CONFIG_DIR/vars/plugins_enabled
if [ -e ${plugin_config} ]; then
  for plugin in `cat ${plugin_config}`; do
    plugin_dir=$AV_INSTALLED_BIN/../../${plugin}/bin
    if [ -d ${plugin_dir} ]; then
    	echo -e "Category ${txtred}$plugin${txtrst}:\n"

		for command in `ls -1 ${plugin_dir}`; do
			printf "    %-20s - %s\n" "$command" "$(${plugin_dir}/$command -h)"
		done

		echo
   	fi
  done
fi


# Local commands
echo -e "Category ${txtred}yours${txtrst}:\n"

for command in ` ls -F $AV_BIN_DIR/ | grep -v '/'`; do
	command=${command%?}
	printf "    %-20s - %s\n" "$command" "`$AV_BIN_DIR/$command -h`"
done

echo

export AV_SINGLE_LINE_HELP=false 

#### End commands
