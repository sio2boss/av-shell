#! /bin/bash


# Import color
source $AV_CONFIG_DIR/default_imports

# Check for a help flag
avCheckHelpFlags "$1" "containers" "Deploy container to mesos/marathon" "\n \
This runs a curl POST with the chosen container's Docker.json file\n \
\n"

# Import system path
avAppendSystemPath

#### Put system commands here
docker_file=$(container_path)/Mesos.json
if [ ! -e ${docker_file} ]; then
	echo -e "${txtred}Unable to find ${docker_file}${txtrst}"
	exit
fi

mesos_server=$(getpv mesos)
if [ -z $mesos_server ]; then
       echo -e "${txtred}Unable to find mesos server via getpv${txtrst}"
       exit
fi

echo -e "Deploying to ${txtgrn}${mesos_server}${txtrst}"

echo "curl -X POST -H \"Content-Type: application/json\" http://${mesos_server}/v2/apps -d @${docker_file}"
curl -X POST -H "Content-Type: application/json" http://${mesos_server}/v2/apps -d @${docker_file}

echo

#### End commands
